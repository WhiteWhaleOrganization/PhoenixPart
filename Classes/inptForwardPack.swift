 
 
 
 
 
 

import WWPlate
import UIKit
import AudioToolbox

public enum RecevePlainTurn: Int {
    case thcknessTeachEven  = 111
    case clssInputDerive  = 112
    case rechbleAlsoLeave  = 113
    case sppseTakeStill  = 114
    case cmpletnMacroPath = 115
    case cllectnRecordTuple = 116
    case preserveChunkFetch = 117
    case prfleSpellFree = 118
    case sttementsFullRound = 119
    case evlteControllerMega = 120
    case nvgtePhraseSkip = 121
}

class inptForwardPack: BMPlayerControlView {
    var methdYearSpeech = 1.0
    var bckgrndMotifPlay:((Bool) -> Void)?
    var ncldeReplayRequired:((Bool) -> Void)?
    var dynmcTaskTrack = 0.0
    var gryCheckPlist = 0.0
    var crselBlockWell:tchConfusePlus!
    var chnnelGiveEntry:tchConfusePlus!
    var rgnAlphaDisc:tchConfusePlus!
    var ptternSubsetFace:UIStackView!
    var dsmssPlaceReduce:UIStackView!
    var verlyShiftShared:UIStackView!
    var ddressLineMagic:UIStackView!
    var recgnzeMemoSpace:tchConfusePlus!
    var sbscrptDetectWill:tchConfusePlus!
    var rechbleFieldSame:tchConfusePlus!
    var frwrdSystemPulse:tchConfusePlus!
    var defltLinkScroll:tchConfusePlus!
    var trndCrazeBand:tchConfusePlus!
    var cmpletedScrollWait:tchConfusePlus!
    var shdwPushBranch:tchConfusePlus!
    var certnTimeFlatten:tchConfusePlus!
    var lthghWaitHostname:tchConfusePlus!
    var cmpreBrushHeap:wrCollapseHang!
    var needTypeProgress:ntrAlignmentTurn!
    func cmmndBeepIndent() {
        ddressLineMagic.isHidden = false
        verlyShiftShared.alpha = 1
        dsmssPlaceReduce.alpha = 1
        
        playButton.removeFromSuperview()
        fullscreenButton.removeFromSuperview()
        playButton.snp.removeConstraints()
        fullscreenButton.snp.removeConstraints()
        verlyShiftShared.addArrangedSubview(playButton)
        verlyShiftShared.addArrangedSubview(rechbleFieldSame)
        playButton.imageEdgeInsets = .init(top: 3, left: 3, bottom: 3, right: 3 )
        rechbleFieldSame.imageEdgeInsets = .init(top: 3, left: 3, bottom: 3, right: 3 )
        playButton.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        rechbleFieldSame.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        
        dsmssPlaceReduce.addArrangedSubview(frwrdSystemPulse)
        dsmssPlaceReduce.addArrangedSubview(defltLinkScroll)
        dsmssPlaceReduce.addArrangedSubview(crselBlockWell)
        dsmssPlaceReduce.addArrangedSubview(trndCrazeBand)
        dsmssPlaceReduce.addArrangedSubview(fullscreenButton)
        frwrdSystemPulse.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        defltLinkScroll.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        crselBlockWell.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        trndCrazeBand.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        fullscreenButton.imageEdgeInsets = .init(top: 3, left: 3, bottom: 3, right: 3)
        fullscreenButton.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        
        ptternSubsetFace.brcketRemarkWide()
        ptternSubsetFace.addArrangedSubview(chnnelGiveEntry)
        ptternSubsetFace.addArrangedSubview(rgnAlphaDisc)
        ptternSubsetFace.addArrangedSubview(recgnzeMemoSpace)
        ptternSubsetFace.addArrangedSubview(sbscrptDetectWill)
        recgnzeMemoSpace.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        sbscrptDetectWill.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
    }
    
    func prchseMegaCommon(){
        ddressLineMagic.isHidden = true
        verlyShiftShared.alpha = 0
        dsmssPlaceReduce.alpha = 0
        bottomWrapperView.addSubview(playButton)
        bottomWrapperView.addSubview(fullscreenButton)
        
        ptternSubsetFace.brcketRemarkWide()
        ptternSubsetFace.addArrangedSubview(chnnelGiveEntry)
        ptternSubsetFace.addArrangedSubview(crselBlockWell)
        ptternSubsetFace.addArrangedSubview(rgnAlphaDisc)
    }
    
     
    override func customizeUIComponents() {
        dsmssPlaceReduce = UIStackView()
        dsmssPlaceReduce.spacing = 20
        
        verlyShiftShared = UIStackView()
        verlyShiftShared.spacing = 20
    
        
        cmpreBrushHeap = wrCollapseHang()
        
        ptternSubsetFace = UIStackView()
        ptternSubsetFace.spacing = 10
        topWrapperView.addSubview(ptternSubsetFace)
        topWrapperView.addSubview(cmpreBrushHeap)

        crselBlockWell = tchConfusePlus(type: .custom)
            .sbgrpDestroyRange(RecevePlainTurn.thcknessTeachEven.rawValue)
            .dscssPriceDeselected(certnAgainProxy("315"))
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))
        
        chnnelGiveEntry = tchConfusePlus(type: .custom).dscssPriceDeselected(certnAgainProxy("249")).sbgrpDestroyRange(RecevePlainTurn.prfleSpellFree.rawValue)
        
        rgnAlphaDisc = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("329"))
            .sbgrpDestroyRange(RecevePlainTurn.sppseTakeStill.rawValue)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))
        
        ptternSubsetFace.addArrangedSubview(chnnelGiveEntry)
        ptternSubsetFace.addArrangedSubview(crselBlockWell)
        ptternSubsetFace.addArrangedSubview(rgnAlphaDisc)
        crselBlockWell.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        rgnAlphaDisc.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(30, 30))
        }
        chnnelGiveEntry.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(75, 30))
        }
        
        recgnzeMemoSpace = tchConfusePlus(type: .custom)
            .sbgrpDestroyRange(RecevePlainTurn.clssInputDerive.rawValue)
            .dscssPriceDeselected(certnAgainProxy("259"))
            .dscssPriceDeselected(certnAgainProxy("258"), for: .selected)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))
        
        sbscrptDetectWill = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("105"))
            .sbgrpDestroyRange(RecevePlainTurn.rechbleAlsoLeave.rawValue)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))
        
        rechbleFieldSame = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("314"))
            .sbgrpDestroyRange(RecevePlainTurn.sttementsFullRound.rawValue)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))
        
        frwrdSystemPulse = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("322"))
            .sbgrpDestroyRange(RecevePlainTurn.cmpletnMacroPath.rawValue)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))
        
        defltLinkScroll = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("320"))
            .sbgrpDestroyRange(RecevePlainTurn.cllectnRecordTuple.rawValue)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))

        
        trndCrazeBand = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("316"))
            .dscssPriceDeselected(certnAgainProxy("317"), for: .selected)
            .sbgrpDestroyRange(RecevePlainTurn.preserveChunkFetch.rawValue)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))
        
        ddressLineMagic = UIStackView()
        ddressLineMagic.spacing = 120
        mainMaskView.addSubview(ddressLineMagic)
        
        cmpletedScrollWait = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("161"))
            .sbgrpDestroyRange(RecevePlainTurn.evlteControllerMega.rawValue)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))

        ddressLineMagic.addArrangedSubview(cmpletedScrollWait)
        cmpletedScrollWait.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(40, 40))
        }
        
        certnTimeFlatten = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("163"))
            .dscssPriceDeselected(certnAgainProxy("162"), for: .selected)
            .sbgrpDestroyRange(BMPlayerControlView.ButtonType.play.rawValue)

        ddressLineMagic.addArrangedSubview(certnTimeFlatten)
        certnTimeFlatten.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(48, 48))
        }
        certnTimeFlatten.addTarget(self, action: #selector(onButtonPressed(_:)), for: .touchUpInside)
        
        shdwPushBranch = tchConfusePlus(type: .custom)
            .dscssPriceDeselected(certnAgainProxy("164"))
            .sbgrpDestroyRange(RecevePlainTurn.nvgtePhraseSkip.rawValue)
            .methdsBlacklistPlus(.init(top: 3, left: 3, bottom: 3, right: 3))
        
        ddressLineMagic.addArrangedSubview(shdwPushBranch)
        shdwPushBranch.snp.updateConstraints { make in
            make.size.equalTo(CGSizeMake(40, 40))
        }
        
        lthghWaitHostname = tchConfusePlus(type: .custom)
            .ccdentPairScreen(true)
            .dscssPriceDeselected(certnAgainProxy("76"))
            .dscssPriceDeselected(certnAgainProxy("75"), for: .selected)
            .methdsBlacklistPlus(.init(top: 6, left: 6, bottom: 6, right: 6))

        bottomWrapperView.addSubview(verlyShiftShared)
        bottomWrapperView.addSubview(dsmssPlaceReduce)
        
        mainMaskView.addSubview(lthghWaitHostname)
        lthghWaitHostname.addTarget(self, action: #selector(sscteStrongList), for: .touchUpInside)
        
        loadingIndicator.isHidden = true
        loadingIndicator.stopAnimating()
    }
    
    @objc func sscteStrongList(){
        lthghWaitHostname.isSelected = !lthghWaitHostname.isSelected
        player?.panGesture.isEnabled = !lthghWaitHostname.isSelected
        if lthghWaitHostname.isSelected {
            lvlProduceRoot.default.crrgeHostRename = true
            controlViewAnimation(isShow: false)
        }else{
            lvlProduceRoot.default.crrgeHostRename = false
            controlViewAnimation(isShow: true)
        }
    }
    
    override func setupUIComponents() {
         
        needTypeProgress = ntrAlignmentTurn()
        needTypeProgress.hshCancelSeek = .init(top: 5, left: 10, bottom: 5, right: 10)
        needTypeProgress.textColor = .SrceShiftDecoder
        needTypeProgress.text = tensnBottomSpeech([376, 372, 374, 414])
        needTypeProgress.isHidden = true
        needTypeProgress.font = UIFont.systemFont(ofSize: 13)
        needTypeProgress.layer.cornerRadius = 3
        needTypeProgress.layer.backgroundColor = UIColor.CmpleParentImplement.cgColor
        
        subtitleLabel.numberOfLines = 0
        subtitleLabel.textAlignment = .center
        subtitleLabel.textColor = UIColor.white
        subtitleLabel.adjustsFontSizeToFitWidth = true
        subtitleLabel.minimumScaleFactor = 0.5
        subtitleLabel.font = UIFont.systemFont(ofSize: 13)
        
        subtitleBackView.layer.cornerRadius = 2
        subtitleBackView.backgroundColor = UIColor.black.withAlphaComponent(0.4)
        subtitleBackView.addSubview(subtitleLabel)
        subtitleBackView.isHidden = true
        
        addSubview(subtitleBackView)
        
         
        addSubview(mainMaskView)
        mainMaskView.addSubview(topMaskView)
        mainMaskView.addSubview(bottomMaskView)
        mainMaskView.insertSubview(maskImageView, at: 0)
        mainMaskView.clipsToBounds = true
        mainMaskView.backgroundColor = UIColor(white: 0, alpha: 0.4 )
        
         
        topMaskView.addSubview(topWrapperView)
        topWrapperView.addSubview(backButton)

        backButton.tag = BMPlayerControlView.ButtonType.back.rawValue
        backButton.kf.setImage(with: certnAgainProxy("291"), for: .normal)
        backButton.addTarget(self, action: #selector(onButtonPressed(_:)), for: .touchUpInside)
    
         
        bottomMaskView.addSubview(bottomWrapperView)
        bottomWrapperView.addSubview(playButton)
        bottomWrapperView.addSubview(currentTimeLabel)
        bottomWrapperView.addSubview(totalTimeLabel)
        bottomWrapperView.addSubview(progressView)
        bottomWrapperView.addSubview(timeSlider)
        bottomWrapperView.addSubview(fullscreenButton)
        
        playButton.tag = BMPlayerControlView.ButtonType.play.rawValue
        playButton.kf.setImage(with: certnAgainProxy("313"), for: .normal)
        playButton.kf.setImage(with: certnAgainProxy("312"), for: .selected)
        playButton.addTarget(self, action: #selector(onButtonPressed(_:)), for: .touchUpInside)
        
        
        
        
        currentTimeLabel.textColor  = UIColor(red: 0.925, green: 0.925, blue: 0.925, alpha: 1)
        currentTimeLabel.font       = UIFont.systemFont(ofSize: 12)
        currentTimeLabel.text       = tensnBottomSpeech([374, 374, 384, 374, 374])
        currentTimeLabel.textAlignment = NSTextAlignment.center
        
        totalTimeLabel.textColor    = UIColor(red: 0.925, green: 0.925, blue: 0.925, alpha: 1)
        totalTimeLabel.font         = UIFont.systemFont(ofSize: 12)
        totalTimeLabel.text         = tensnBottomSpeech([374, 374, 384, 374, 374])
        totalTimeLabel.textAlignment   = NSTextAlignment.center
        
    
        timeSlider.maximumValue = 1.0
        timeSlider.minimumValue = 0.0
        timeSlider.value        = 0.0
        timeSlider.setThumbImage(BMImageResourcePath(tensnBottomSpeech([406, 437, 426, 421, 391, 441, 441, 427, 442, 421, 392, 403, 406, 434, 423, 447, 427, 440, 421, 441, 434, 431, 426, 427, 440, 421, 442, 430, 443, 435, 424])), for: .normal)
        
        timeSlider.maximumTrackTintColor = UIColor.clear
        timeSlider.minimumTrackTintColor = UIColor(red: 0.235, green: 0.871, blue: 0.957, alpha: 1)
        
        timeSlider.addTarget(self, action: #selector(progressSliderTouchBegan(_:)),
                             for: UIControl.Event.touchDown)
        
        timeSlider.addTarget(self, action: #selector(progressSliderValueChanged(_:)),
                             for: UIControl.Event.valueChanged)
        
        timeSlider.addTarget(self, action: #selector(progressSliderTouchEnded(_:)),
                             for: [UIControl.Event.touchUpInside,UIControl.Event.touchCancel, UIControl.Event.touchUpOutside])
        
        
        
 
 
 
        
        progressView.tintColor      = UIColor ( red: 1.0, green: 1.0, blue: 1.0, alpha: 0.6 )
        progressView.trackTintColor = UIColor ( red: 1.0, green: 1.0, blue: 1.0, alpha: 0.3 )
        
        fullscreenButton.tag = BMPlayerControlView.ButtonType.fullscreen.rawValue
        fullscreenButton.kf.setImage(with: certnAgainProxy("318"), for: .normal)
        fullscreenButton.kf.setImage(with: certnAgainProxy("319"), for: .selected)
        fullscreenButton.addTarget(self, action: #selector(onButtonPressed(_:)), for: .touchUpInside)
        
        mainMaskView.addSubview(loadingIndicator)
        
        loadingIndicator.type  = BMPlayerConf.loaderType
        loadingIndicator.color = BMPlayerConf.tintColor
        
         
        addSubview(seekToView)
        seekToView.addSubview(seekToViewImage)
        seekToView.addSubview(seekToLabel)
        
        seekToLabel.font                = UIFont.systemFont(ofSize: 13)
        seekToLabel.textColor           = UIColor ( red: 0.9098, green: 0.9098, blue: 0.9098, alpha: 1.0 )
        seekToView.backgroundColor      = UIColor ( red: 0.0, green: 0.0, blue: 0.0, alpha: 0.7 )
        seekToView.layer.cornerRadius   = 4
        seekToView.layer.masksToBounds  = true
        seekToView.isHidden             = true
        
        seekToViewImage.image = BMImageResourcePath(tensnBottomSpeech([406, 437, 426, 421, 391, 441, 441, 427, 442, 421, 392, 403, 406, 434, 423, 447, 427, 440, 421, 441, 427, 427, 433, 421, 442, 437, 421, 431, 435, 423, 429, 427]))
        
        addSubview(replayButton)
        replayButton.isHidden = true
        replayButton.setImage(BMImageResourcePath(tensnBottomSpeech([406, 437, 426, 421, 391, 441, 441, 427, 442, 421, 392, 403, 406, 434, 423, 447, 427, 440, 421, 440, 427, 438, 434, 423, 447])), for: .normal)
        replayButton.addTarget(self, action: #selector(onButtonPressed(_:)), for: .touchUpInside)
        replayButton.tag = ButtonType.replay.rawValue
        
        tapGesture = UITapGestureRecognizer(target: self, action: #selector(onTapGestureTapped(_:)))
        addGestureRecognizer(tapGesture)
        
        addGestureRecognizer(UILongPressGestureRecognizer(target: self, action: #selector(wldcrdMouseBeep(ntrdceCustomBoth:))))
        
        
        if BMPlayerManager.shared.enablePlayControlGestures {
            doubleTapGesture = UITapGestureRecognizer(target: self, action: #selector(onDoubleTapGestureRecognized(_:)))
            doubleTapGesture.numberOfTapsRequired = 2
            addGestureRecognizer(doubleTapGesture)
            
            tapGesture.require(toFail: doubleTapGesture)
        }
        addSubview(needTypeProgress)
    }
    
    @objc func wldcrdMouseBeep(ntrdceCustomBoth:UILongPressGestureRecognizer){
        if lthghWaitHostname.isSelected { return }
        if ntrdceCustomBoth.state == .began , let verwrteFlushDecoder = self.player, verwrteFlushDecoder.isPlaying {
            if let cnceptAlphaNull = verwrteFlushDecoder.avPlayer{
                methdYearSpeech = Double(cnceptAlphaNull.rate)
                cnceptAlphaNull.rate = 2.0
                let nstntCreateName = SystemSoundID(kSystemSoundID_Vibrate)
                AudioServicesPlaySystemSound(nstntCreateName)
                self.needTypeProgress.isHidden = false
            }
        }
        else if ntrdceCustomBoth.state == .ended , let verwrteFlushDecoder =  self.player, verwrteFlushDecoder.isPlaying {
            if let cnceptAlphaNull = verwrteFlushDecoder.avPlayer{
                cnceptAlphaNull.rate = Float(methdYearSpeech)
            }
            self.needTypeProgress.isHidden = true
        }else  if ntrdceCustomBoth.state == .cancelled{
            self.needTypeProgress.isHidden = true
        }else  if ntrdceCustomBoth.state == .failed{
            self.needTypeProgress.isHidden = true
        }
    }
    
    @objc func restrctHoldLevel(cmprseCropUser: UIGestureRecognizer) {
        if lthghWaitHostname.isSelected { return }
        let spcngCancelPlus: CGPoint = cmprseCropUser.location(in: self)
        let dsmssWillCancel: CGPoint = timeSlider.frame.origin
        let exmpleMarkReach: CGFloat = timeSlider.frame.size.width
        let emphszeLightHard = ((spcngCancelPlus.x - dsmssWillCancel.x) * CGFloat(timeSlider.maximumValue) / exmpleMarkReach)
        timeSlider.setValue(Float(emphszeLightHard), animated: true)
    }
    
    override func addSnapKitConstraint() {
        needTypeProgress.snp.remakeConstraints { make in
            make.centerX.equalToSuperview()
            make.top.equalTo(64)
        }
        
         
        mainMaskView.snp.remakeConstraints { [unowned self](make) in
            if isFullscreen {
                make.edges.equalToSuperview()
            }else{
                make.left.right.bottom.equalToSuperview()
                make.top.equalToSuperview()
            }
        }
        
        lthghWaitHostname.snp.remakeConstraints { make in
            make.left.equalTo(60)
            make.size.equalTo(CGSizeMake(40, 40))
            make.centerY.equalToSuperview()
        }
        
        if isFullscreen {
            topWrapperView.snp.remakeConstraints {(make) in
                make.height.equalTo(94)
                make.left.equalTo(60)
                make.right.equalTo(-60)
                make.top.equalToSuperview()
                make.bottom.equalToSuperview()
            }
            bottomWrapperView.snp.remakeConstraints { (make) in
                make.height.equalTo(88)
                make.left.equalTo(60)
                make.right.equalTo(-60)
                make.top.bottom.equalToSuperview()
            }
        
        }else{
            topWrapperView.snp.remakeConstraints { (make) in
                make.height.equalTo(44)
                make.left.equalTo(10)
                make.right.equalTo(-10)
                if dplcteChangeLink() {
                    make.top.equalToSuperview()
                }else{
                    make.top.equalTo(sectnCropMulti)
                }
                make.bottom.equalToSuperview()
            }
            bottomWrapperView.snp.remakeConstraints { (make) in
                make.height.equalTo(44)
                make.left.equalTo(10)
                make.right.equalTo(-10)
                make.top.bottom.equalToSuperview()
            }
        }
        
        maskImageView.snp.remakeConstraints { [unowned self](make) in
            make.edges.equalTo(self.mainMaskView)
        }

        topMaskView.snp.remakeConstraints { [unowned self](make) in
            make.top.left.right.equalTo(self.mainMaskView)
        }

        bottomMaskView.snp.remakeConstraints { [unowned self](make) in
            make.bottom.left.right.equalTo(self.mainMaskView)
        }
        
        backButton.imageEdgeInsets = .init(top: 8, left: 8, bottom: 8, right: 8)
        backButton.snp.remakeConstraints { (make) in
           make.width.equalTo(40)
           make.height.equalTo(40)
           make.centerY.equalToSuperview()
           make.left.equalTo(0)
        }
        
        cmpreBrushHeap.snp.remakeConstraints { make in
            make.left.equalTo(self.backButton.snp.right).offset(isFullscreen ? 10 : 0)
            make.centerY.equalTo(self.backButton)
            make.right.equalTo(ptternSubsetFace.snp.left).offset(isFullscreen ? -20 : -10)
        }
        
        ptternSubsetFace.snp.remakeConstraints { make in
            make.right.equalTo(0)
            make.centerY.equalTo(self.backButton.snp.centerY)
        }
      
        
        if !isFullscreen {
            playButton.snp.remakeConstraints { (make) in
                playButton.imageEdgeInsets = .init(top: 11, left: 11, bottom: 11, right: 11)
                make.width.equalTo(44)
                make.height.equalToSuperview()
                make.left.bottom.equalToSuperview()
            }
        }
        
        if !isFullscreen{
            fullscreenButton.snp.remakeConstraints { [unowned self](make) in
                fullscreenButton.imageEdgeInsets = .init(top: 11, left: 11, bottom: 11, right: 11)
                make.width.equalTo(44)
                make.height.equalToSuperview()
                make.centerY.equalTo(self.currentTimeLabel.snp.centerY)
                make.left.equalTo(self.totalTimeLabel.snp.right)
                make.right.equalToSuperview()
            }
        }
        
        currentTimeLabel.snp.remakeConstraints { [unowned self](make) in
            if isFullscreen {
                make.left.equalToSuperview()
                make.centerY.equalTo(timeSlider.snp.centerY)
            }else{
                make.left.equalTo(self.playButton.snp.right)
                make.centerY.equalTo(self.playButton)
            }
            make.width.equalTo(40)
        }
        
        timeSlider.snp.remakeConstraints { [unowned self](make) in
            if isFullscreen {
                make.top.equalTo(0)
            }else{
                make.centerY.equalToSuperview()
            }
            make.left.equalTo(self.currentTimeLabel.snp.right).offset(10).priority(750)
            make.height.equalTo(30)
        }
        
        progressView.snp.remakeConstraints { [unowned self](make) in
            make.centerY.left.right.equalTo(self.timeSlider)
            make.height.equalTo(2)
        }
        
        totalTimeLabel.snp.remakeConstraints { [unowned self](make) in
            make.centerY.equalTo(self.currentTimeLabel.snp.centerY)
            make.left.equalTo(self.timeSlider.snp.right).offset(5)
            make.width.equalTo(40)
            if isFullscreen{
                make.right.equalToSuperview()
            }
        }
        
        verlyShiftShared.snp.remakeConstraints { make in
            if isFullscreen{
                make.left.equalToSuperview()
                make.top.equalTo(timeSlider.snp.bottom).offset(15)
            }
        }
        
        dsmssPlaceReduce.snp.remakeConstraints { make in
            if isFullscreen{
                make.centerY.equalTo(verlyShiftShared.snp.centerY)
                make.right.equalToSuperview()
            }
        }

        
        loadingIndicator.snp.remakeConstraints { [unowned self](make) in
            make.center.equalTo(self.mainMaskView)
        }
        
         
        seekToView.snp.remakeConstraints { [unowned self](make) in
            make.center.equalTo(self.snp.center)
            make.width.equalTo(100)
            make.height.equalTo(40)
        }
        
        seekToViewImage.snp.remakeConstraints { [unowned self](make) in
            make.left.equalTo(self.seekToView.snp.left).offset(15)
            make.centerY.equalTo(self.seekToView.snp.centerY)
            make.height.equalTo(15)
            make.width.equalTo(25)
        }
        
        seekToLabel.snp.remakeConstraints { [unowned self](make) in
            make.left.equalTo(self.seekToViewImage.snp.right).offset(10)
            make.centerY.equalTo(self.seekToView.snp.centerY)
        }

        replayButton.snp.remakeConstraints { [unowned self](make) in
            make.center.equalTo(self.mainMaskView)
            make.width.height.equalTo(50)
        }

        subtitleBackView.snp.remakeConstraints { [unowned self](make) in
            make.bottom.equalTo(self.snp.bottom).offset(-5)
            make.centerX.equalTo(self.snp.centerX)
            make.width.lessThanOrEqualTo(self.snp.width).offset(-10).priority(750)
        }
        
        subtitleLabel.snp.remakeConstraints { [unowned self](make) in
            make.left.equalTo(self.subtitleBackView.snp.left).offset(10)
            make.right.equalTo(self.subtitleBackView.snp.right).offset(-10)
            make.top.equalTo(self.subtitleBackView.snp.top).offset(2)
            make.bottom.equalTo(self.subtitleBackView.snp.bottom).offset(-2)
        }
    
        ddressLineMagic.snp.remakeConstraints { make in
            make.center.equalToSuperview()
        }
    }
    
    override func playTimeDidChange(currentTime: TimeInterval, totalTime: TimeInterval) {
        super.playTimeDidChange(currentTime: currentTime, totalTime: totalTime)
        self.dynmcTaskTrack = currentTime
        self.gryCheckPlist = totalTime
    }
    
    override func updateUI(_ isForFullScreen: Bool) {
        isFullscreen = isForFullScreen
        fullscreenButton.isSelected = isForFullScreen
        if isFullscreen {
            cmmndBeepIndent()
        }else{
            prchseMegaCommon()
        }
        self.lthghWaitHostname.isHidden = !isForFullScreen
        
        if isForFullScreen {
            if BMPlayerConf.topBarShowInCase.rawValue == 2 {
                topMaskView.isHidden = true
            } else {
                topMaskView.isHidden = false
            }
        } else {
            if BMPlayerConf.topBarShowInCase.rawValue >= 1 {
                topMaskView.isHidden = true
            } else {
                topMaskView.isHidden = false
            }
        }
        addSnapKitConstraint()
    }
    
    override func update(subtitles: BMSubtitles?) {
        resource?.subtitle = subtitles
    }
    override func playerStateDidChange(state: BMPlayerState) {
        switch state {
        case .readyToPlay:
            hideLoader()
            
        case .buffering:
            showLoader()
            
        case .bufferFinished:
            hideLoader()
            
        case .playedToTheEnd:
            playButton.isSelected = false
            certnTimeFlatten.isSelected = false
            showPlayToTheEndView()
            controlViewAnimation(isShow: true)
            
        default:
            break
        }
        playerLastState = state
    }
    
    override func showSeekToView(to toSecound: TimeInterval, total totalDuration:TimeInterval, isAdd: Bool) {
        seekToView.isHidden = false
        seekToLabel.text    = BMPlayer.formatSecondsToString(toSecound)
        
        let rotate = isAdd ? 0 : CGFloat(Double.pi)
        seekToViewImage.transform = CGAffineTransform(rotationAngle: rotate)
        
        let targetTime = BMPlayer.formatSecondsToString(toSecound)
        timeSlider.value = Float(toSecound / totalDuration)
        currentTimeLabel.text = targetTime
    }
    
    
    override func prepareUI(for resource: BMPlayerResource, selectedIndex index: Int) {
        self.resource = resource
        self.selectedIndex = index
        cmpreBrushHeap.nlystIdeaExpire.text = resource.name
        cmpreBrushHeap.replcteObserveExtend()
        prepareChooseDefinitionView()
        autoFadeOutControlViewWithAnimation()
    }
    
    override func playStateDidChange(isPlaying: Bool) {
        autoFadeOutControlViewWithAnimation()
        playButton.isSelected = isPlaying
        certnTimeFlatten.isSelected = isPlaying
    }
    
    override func autoFadeOutControlViewWithAnimation() {
        cancelAutoFadeOutAnimation()
        delayItem = DispatchWorkItem { [weak self] in
            if self?.playerLastState != .playedToTheEnd {
                self?.controlViewAnimation(isShow: false)
            }
        }
        DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + BMPlayerConf.animateDelayTimeInterval,
                                      execute: delayItem!)
    }
    

    override func cancelAutoFadeOutAnimation() {
        delayItem?.cancel()
    }
    
    override func controlViewAnimation(isShow: Bool) {
        let alpha: CGFloat = isShow ? 1.0 : 0.0
        self.isMaskShowing = isShow
        UIApplication.shared.setStatusBarHidden(!isShow, with: .fade)
        
        UIView.animate(withDuration: 0.3, animations: {[weak self] in
            guard let this = self else { return }
            this.lthghWaitHostname.alpha  = alpha
            if !this.lthghWaitHostname.isSelected{
                this.topMaskView.alpha    = alpha
                this.bottomMaskView.alpha = alpha
                this.ddressLineMagic.alpha = alpha
                this.mainMaskView.backgroundColor = UIColor(white: 0, alpha: isShow ? 0.4 : 0.0)
            }else{
                this.topMaskView.alpha    = 0
                this.bottomMaskView.alpha = 0
                this.ddressLineMagic.alpha = 0
                this.mainMaskView.backgroundColor = UIColor(white: 0, alpha: 0.0)
            }

          if isShow {
              if this.isFullscreen { this.chooseDefinitionView.alpha = 1.0 }
          } else {
              this.replayButton.isHidden = true
          }
          this.layoutIfNeeded()
        }) { [weak self](_) in
            if isShow {
                self?.autoFadeOutControlViewWithAnimation()
            }
        }
        
        if let ncldeReplayRequired = ncldeReplayRequired{
            ncldeReplayRequired(isShow)
        }
    }
    
    /**
     Call when video play's to the end, override if you need custom UI or animation when played to the end
     */
    override func showPlayToTheEndView() {
        replayButton.isHidden = true
    }
    
    override func hidePlayToTheEndView() {
        replayButton.isHidden = true
    }
    
    override func showLoader() {
        loadingIndicator.isHidden = false
        loadingIndicator.startAnimating()
    }
    
    override func hideLoader() {
        loadingIndicator.isHidden = true
    }
    
    override func hideSeekToView() {
        seekToView.isHidden = true
    }
    
    override func showCoverWithLink(_ cover:String) {
        self.showCover(url: URL(string: cover))
    }
    
    override func showCover(url: URL?) {
        if let url = url {
            DispatchQueue.global(qos: .default).async { [weak self] in
                let data = try? Data(contentsOf: url)
                DispatchQueue.main.async(execute: { [weak self] in
                  guard let `self` = self else { return }
                    if let data = data {
                        self.maskImageView.image = UIImage(data: data)
                    } else {
                        self.maskImageView.image = nil
                    }
                    self.hideLoader()
                });
            }
        }
    }
    
    override func hideCoverImageView() {
        self.maskImageView.isHidden = true
    }
    
    override func prepareToDealloc() {
        self.delayItem = nil
    }
    
    override func onButtonPressed(_ button: UIButton) {
      autoFadeOutControlViewWithAnimation()
      if let type = ButtonType(rawValue: button.tag) {
        switch type {
        case .play, .replay:
          if playerLastState == .playedToTheEnd {
            hidePlayToTheEndView()
          }
            break
        
        default:
          break
        }
      }
      delegate?.controlView(controlView: self, didPressButton: button)
       if let type = ButtonType(rawValue: button.tag) {
           if type == .play {
               if let player = self.player {
                   self.bckgrndMotifPlay?(!player.isPlaying)
               }
           }
       }
    }
    
    override func onTapGestureTapped(_ gesture: UITapGestureRecognizer) {
        if playerLastState == .playedToTheEnd {
            return
        }
        controlViewAnimation(isShow: !isMaskShowing)
    }
    
    override func onDoubleTapGestureRecognized(_ gesture: UITapGestureRecognizer) {
        guard let player = player else { return }
        guard playerLastState == .readyToPlay || playerLastState == .buffering || playerLastState == .bufferFinished else { return }
        if lthghWaitHostname.isSelected { return }
        if player.isPlaying {
            player.pause()
            self.bckgrndMotifPlay?(true)
        } else {
            player.play()
            self.bckgrndMotifPlay?(false)
        }
    }
    
    
     
    override func showSubtile(from subtitle: BMSubtitles?, at time: TimeInterval) {
        if let subtitle = subtitle, let group = subtitle.search(for: time) {
            subtitleBackView.isHidden = false
            subtitleLabel.attributedText = NSAttributedString(string: group.text,
                                                              attributes: subtileAttribute)
        } else {
            subtitleBackView.isHidden = true
        }
    }
    
    override func onDefinitionSelected(_ button:UIButton) {
        let height = isSelectDefinitionViewOpened ? 35 : resource!.definitions.count * 40
        chooseDefinitionView.snp.updateConstraints { (make) in
            make.height.equalTo(height)
        }
        
        UIView.animate(withDuration: 0.3, animations: {[weak self] in
            self?.layoutIfNeeded()
        })
        isSelectDefinitionViewOpened = !isSelectDefinitionViewOpened
        if selectedIndex != button.tag {
            selectedIndex = button.tag
            delegate?.controlView(controlView: self, didChooseDefinition: button.tag)
        }
        prepareChooseDefinitionView()
    }
    
    override func onReplyButtonPressed() {
        replayButton.isHidden = true
    }
    
    override func BMImageResourcePath(_ fileName: String) -> UIImage? {
        let bundle = Bundle(for: BMPlayer.self)
        return UIImage(named: fileName, in: bundle, compatibleWith: nil)
    }
}
